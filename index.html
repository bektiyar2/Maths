<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ 1-7 –∫–ª–∞—Å—Å–æ–≤ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö">
    <meta name="theme-color" content="#0077b6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #00a8cc 0%, #0077b6 50%, #023e8a 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        h1 {
            color: #0077b6;
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        .install-prompt {
            display: none;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        .install-btn {
            background: white;
            color: #38a169;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
            border-radius: 12px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #0077b6;
        }
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        .achievements {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .achievement {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            background: #e0e0e0;
            transition: all 0.3s;
        }
        .achievement.unlocked {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .grade-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .grade-btn {
            padding: 20px;
            border: 3px solid #0077b6;
            background: white;
            color: #0077b6;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s;
        }
        .grade-btn:hover {
            background: #0077b6;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,119,182,0.3);
        }
        .topic-selection {
            display: none;
        }
        .topic-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .topic-btn {
            padding: 15px;
            border: 2px solid #023e8a;
            background: white;
            color: #023e8a;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            text-align: left;
        }
        .topic-btn:hover {
            background: #023e8a;
            color: white;
            transform: translateX(5px);
        }
        .quiz-area {
            display: none;
        }
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00a8cc 0%, #0077b6 100%);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .question-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid #0077b6;
        }
        .question-type {
            color: #0077b6;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .question-text {
            font-size: 1.4em;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .answer-input {
            width: 100%;
            padding: 15px;
            font-size: 1.3em;
            border: 3px solid #ddd;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
            transition: all 0.3s;
        }
        .answer-input:focus {
            outline: none;
            border-color: #0077b6;
            box-shadow: 0 0 10px rgba(0,119,182,0.2);
        }
        .btn {
            padding: 14px 35px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            font-weight: bold;
        }
        .check-btn {
            background: linear-gradient(135deg, #0077b6 0%, #023e8a 100%);
            color: white;
        }
        .check-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,119,182,0.3);
        }
        .next-btn {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(72,187,120,0.3);
        }
        .back-btn {
            background: #6c757d;
            color: white;
        }
        .back-btn:hover {
            background: #5a6268;
        }
        .hint-btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
            color: white;
        }
        .feedback {
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            animation: slideIn 0.3s;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .correct {
            background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%);
            color: #22543d;
            border-left: 5px solid #48bb78;
        }
        .incorrect {
            background: linear-gradient(135deg, #fed7d7 0%, #fc8181 100%);
            color: #742a2a;
            border-left: 5px solid #f56565;
        }
        .hint {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            color: #78350f;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #fbbf24;
        }
        .button-group {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="installPrompt" class="install-prompt">
            <div>üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω!</div>
            <button class="install-btn" onclick="installApp()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        </div>
        
        <div class="header">
            <h1>üéì –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</h1>
            <p class="subtitle">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö</p>
        </div>
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalScore">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ –±–∞–ª–ª–æ–≤</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="sessionScore">0/0</div>
                <div class="stat-label">–í —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streakDisplay">0üî•</div>
                <div class="stat-label">–°–µ—Ä–∏—è</div>
            </div>
        </div>
        <div class="achievements" id="achievements">
            <div class="achievement" id="ach1" title="–ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞">üåü</div>
            <div class="achievement" id="ach2" title="10 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö">‚≠ê</div>
            <div class="achievement" id="ach3" title="–°–µ—Ä–∏—è 5">üî•</div>
            <div class="achievement" id="ach4" title="50 –∑–∞–¥–∞—á">üèÜ</div>
            <div class="achievement" id="ach5" title="–ú–∞—Å—Ç–µ—Ä">üëë</div>
        </div>
        <div id="gradeSelection">
            <h2 style="text-align: center; color: #0077b6; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å:</h2>
            <div class="grade-selection">
                <button class="grade-btn" onclick="selectGrade(1)">1<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(2)">2<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(3)">3<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(4)">4<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(5)">5<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(6)">6<br>–∫–ª–∞—Å—Å</button>
                <button class="grade-btn" onclick="selectGrade(7)">7<br>–∫–ª–∞—Å—Å</button>
            </div>
        </div>
        <div id="topicSelection" class="topic-selection">
            <h2 style="text-align: center; color: #0077b6; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É:</h2>
            <div class="topic-grid" id="topicButtons"></div>
            <div style="text-align: center;">
                <button class="btn back-btn" onclick="backToGrades()">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–ª–∞—Å—Å–∞–º</button>
            </div>
        </div>
        <div id="quizArea" class="quiz-area">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            <div class="question-card">
                <div class="question-type" id="questionType"></div>
                <div class="question-text" id="question"></div>
            </div>
            <input type="text" class="answer-input" id="answerInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç">
            <div class="button-group">
                <button class="btn check-btn" onclick="checkAnswer()">‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <button class="btn hint-btn" onclick="showHint()">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                <button class="btn next-btn" onclick="nextQuestion()">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</button>
            </div>
            <div id="hintArea"></div>
            <div id="feedback"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn back-btn" onclick="backToTopics()">‚Üê –ù–∞–∑–∞–¥ –∫ —Ç–µ–º–∞–º</button>
            </div>
        </div>
    </div>
    <script>
        let currentGrade=0,currentTopic='',currentQuestion=null,correctAnswers=0,totalQuestions=0,streak=0,totalScore=0,questionsInSession=0,hintsUsed=0;
        const topics={1:['–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 10','–°–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10','–í—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10','–ß–∏—Å–ª–∞ –æ—Ç 11 –¥–æ 20','–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–µ–ª','–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á'],2:['–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 100','–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 20','–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 100','–£–º–Ω–æ–∂–µ–Ω–∏–µ (—Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ 2, 3, 4)','–î–µ–ª–µ–Ω–∏–µ','–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏'],3:['–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 1000','–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ —Ç—Ä—ë—Ö–∑–Ω–∞—á–Ω—ã—Ö —á–∏—Å–µ–ª','–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ (–≤—Å—è —Ç–∞–±–ª–∏—Ü–∞)','–í–Ω–µ—Ç–∞–±–ª–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ','–î–æ–ª–∏ –∏ –¥—Ä–æ–±–∏','–ó–∞–¥–∞—á–∏ –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ'],4:['–ú–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã–µ —á–∏—Å–ª–∞','–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è','–ü–∏—Å—å–º–µ–Ω–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ','–°–∫–æ—Ä–æ—Å—Ç—å, –≤—Ä–µ–º—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ','–ü–ª–æ—â–∞–¥—å –∏ –ø–µ—Ä–∏–º–µ—Ç—Ä','–î—Ä–æ–±–∏ –∏ —Å–º–µ—à–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞'],5:['–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –∏ –¥–µ–π—Å—Ç–≤–∏—è —Å –Ω–∏–º–∏','–û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –¥—Ä–æ–±–∏','–î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏','–ü—Ä–æ—Ü–µ–Ω—Ç—ã','–ü–ª–æ—â–∞–¥—å –∏ –æ–±—ä—ë–º','–£—Ä–∞–≤–Ω–µ–Ω–∏—è'],6:['–î–µ–ª–∏–º–æ—Å—Ç—å —á–∏—Å–µ–ª','–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞','–ú–æ–¥—É–ª—å —á–∏—Å–ª–∞','–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞','–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è','–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å'],7:['–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è','–õ–∏–Ω–µ–π–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è','–°—Ç–µ–ø–µ–Ω–∏ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞','–û–¥–Ω–æ—á–ª–µ–Ω—ã –∏ –º–Ω–æ–≥–æ—á–ª–µ–Ω—ã','–§–æ—Ä–º—É–ª—ã —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è','–°–∏—Å—Ç–µ–º—ã –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π']};
        
        // PWA Installation
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installPrompt').style.display = 'block';
        });
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').style.display = 'none';
                });
            }
        }
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(function(registration) {
                console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
            }).catch(function(err) {
                console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', err);
            });
        }
        
        function loadProgress(){const saved=localStorage.getItem('mathProgress');if(saved){const data=JSON.parse(saved);totalScore=data.totalScore||0;updateDisplay();checkAchievements();}}
        function saveProgress(){localStorage.setItem('mathProgress',JSON.stringify({totalScore,correctAnswers,totalQuestions:questionsInSession}));}
        function selectGrade(grade){currentGrade=grade;document.getElementById('gradeSelection').style.display='none';document.getElementById('topicSelection').style.display='block';const topicButtons=document.getElementById('topicButtons');topicButtons.innerHTML='';topics[grade].forEach(topic=>{const btn=document.createElement('button');btn.className='topic-btn';btn.textContent=topic;btn.onclick=()=>selectTopic(topic);topicButtons.appendChild(btn);});}
        function selectTopic(topic){currentTopic=topic;correctAnswers=0;questionsInSession=0;document.getElementById('topicSelection').style.display='none';document.getElementById('quizArea').style.display='block';generateQuestion();}
        function generateQuestion(){document.getElementById('feedback').innerHTML='';document.getElementById('hintArea').innerHTML='';document.getElementById('answerInput').value='';hintsUsed=0;let question,answer,hint,type='–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞';switch(currentTopic){case'–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 10':case'–°–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10':const a1=Math.floor(Math.random()*9)+1;const b1=Math.floor(Math.random()*(10-a1))+1;question=`${a1} + ${b1} = ?`;answer=a1+b1;hint=`–ü–æ–ø—Ä–æ–±—É–π –ø–æ—Å—á–∏—Ç–∞—Ç—å –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö: ${a1} –ø–∞–ª—å—Ü–µ–≤ –∏ –µ—â—ë ${b1}`;break;case'–í—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10':const a2=Math.floor(Math.random()*9)+2;const b2=Math.floor(Math.random()*a2)+1;question=`${a2} - ${b2} = ?`;answer=a2-b2;hint=`–£ —Ç–µ–±—è –±—ã–ª–æ ${a2}, –æ—Ç–Ω—è–ª–∏ ${b2}. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?`;break;case'–ß–∏—Å–ª–∞ –æ—Ç 11 –¥–æ 20':case'–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 20':const a3=Math.floor(Math.random()*15)+5;const b3=Math.floor(Math.random()*(20-a3))+1;question=`${a3} + ${b3} = ?`;answer=a3+b3;hint='–†–∞–∑–ª–æ–∂–∏ –Ω–∞ –¥–µ—Å—è—Ç–∫–∏ –∏ –µ–¥–∏–Ω–∏—Ü—ã';break;case'–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–µ–ª':type='–°—Ä–∞–≤–Ω–µ–Ω–∏–µ';const n1=Math.floor(Math.random()*20)+1;const n2=Math.floor(Math.random()*20)+1;question=`–ö–∞–∫–æ–µ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ: ${n1} –∏–ª–∏ ${n2}? (–í–≤–µ–¥–∏ –±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ)`;answer=Math.max(n1,n2);hint='–ü–æ—Å–º–æ—Ç—Ä–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ —á–∏—Å–ª–∞';break;case'–£–º–Ω–æ–∂–µ–Ω–∏–µ (—Ç–∞–±–ª–∏—Ü–∞ –Ω–∞ 2, 3, 4)':case'–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ (–≤—Å—è —Ç–∞–±–ª–∏—Ü–∞)':const mult=[2,3,4,5,6,7,8,9][Math.floor(Math.random()*8)];const num=Math.floor(Math.random()*9)+2;question=`${mult} √ó ${num} = ?`;answer=mult*num;hint=`${mult} –ø–æ–≤—Ç–æ—Ä–∏—Ç—å ${num} —Ä–∞–∑`;break;case'–î–µ–ª–µ–Ω–∏–µ':case'–í–Ω–µ—Ç–∞–±–ª–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ':const div=Math.floor(Math.random()*9)+2;const res=Math.floor(Math.random()*9)+2;const total=div*res;question=`${total} √∑ ${div} = ?`;answer=res;hint=`–ö–∞–∫–æ–µ —á–∏—Å–ª–æ —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ ${div}, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å ${total}?`;break;case'–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 100':case'–ß–∏—Å–ª–∞ –æ—Ç 1 –¥–æ 100':const a4=Math.floor(Math.random()*80)+10;const b4=Math.floor(Math.random()*30)+5;const op=Math.random()>0.5?'+':'-';if(op==='+'){question=`${a4} + ${b4} = ?`;answer=a4+b4;}else{question=`${a4} - ${b4} = ?`;answer=a4-b4;}hint='–°—á–∏—Ç–∞–π –¥–µ—Å—è—Ç–∫–∞–º–∏, –ø–æ—Ç–æ–º –µ–¥–∏–Ω–∏—Ü–∞–º–∏';break;case'–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á':case'–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏':type='–ó–∞–¥–∞—á–∞';const stories=[{text:'–£ –ê–π–≥—É–ª—å –±—ã–ª–æ {0} —è–±–ª–æ–∫. –û–Ω–∞ –æ—Ç–¥–∞–ª–∞ {1} —è–±–ª–æ–∫ –ø–æ–¥—Ä—É–≥–µ. –°–∫–æ–ª—å–∫–æ —è–±–ª–æ–∫ –æ—Å—Ç–∞–ª–æ—Å—å?',gen:()=>{const x=Math.floor(Math.random()*15)+5;const y=Math.floor(Math.random()*x/2)+1;return[x,y,x-y];}},{text:'–í –∫–ª–∞—Å—Å–µ {0} –º–∞–ª—å—á–∏–∫–æ–≤ –∏ {1} –¥–µ–≤–æ—á–µ–∫. –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –¥–µ—Ç–µ–π?',gen:()=>{const x=Math.floor(Math.random()*15)+10;const y=Math.floor(Math.random()*15)+10;return[x,y,x+y];}},{text:'–ê—Å–µ–ª—å –∫—É–ø–∏–ª–∞ {0} —Ç–µ—Ç—Ä–∞–¥–µ–π –ø–æ {1} —Ç–µ–Ω–≥–µ. –°–∫–æ–ª—å–∫–æ –æ–Ω–∞ –∑–∞–ø–ª–∞—Ç–∏–ª–∞?',gen:()=>{const x=Math.floor(Math.random()*5)+2;const y=[10,20,30,50][Math.floor(Math.random()*4)];return[x,y,x*y];}}];const story=stories[Math.floor(Math.random()*stories.length)];const vals=story.gen();question=story.text.replace('{0}',vals[0]).replace('{1}',vals[1]);answer=vals[2];hint='–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–π –∑–∞–¥–∞—á—É. –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏?';break;case'–î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏':const d1=(Math.floor(Math.random()*50)+10)/10;const d2=(Math.floor(Math.random()*30)+5)/10;question=`${d1} + ${d2} = ?`;answer=Math.round((d1+d2)*10)/10;hint='–°–∫–ª–∞–¥—ã–≤–∞–π –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ —á–∏—Å–ª–∞, –Ω–µ –∑–∞–±—É–¥—å –ø—Ä–æ –∑–∞–ø—è—Ç—É—é';break;case'–ü—Ä–æ—Ü–µ–Ω—Ç—ã':type='–ü—Ä–æ—Ü–µ–Ω—Ç—ã';const base=[100,200,500][Math.floor(Math.random()*3)];const perc=[10,20,50][Math.floor(Math.random()*3)];question=`–ù–∞–π–¥–∏ ${perc}% –æ—Ç ${base}`;answer=base*perc/100;hint=`${perc}% = ${perc}/100. –£–º–Ω–æ–∂—å ${base} –Ω–∞ ${perc} –∏ —Ä–∞–∑–¥–µ–ª–∏ –Ω–∞ 100`;break;case'–£—Ä–∞–≤–Ω–µ–Ω–∏—è':case'–õ–∏–Ω–µ–π–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è':type='–£—Ä–∞–≤–Ω–µ–Ω–∏–µ';const x=Math.floor(Math.random()*20)+1;const c=Math.floor(Math.random()*30)+10;question=`x + ${c} = ${x+c}. –ù–∞–π–¥–∏ x`;answer=x;hint=`–ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–∏–±–∞–≤–∏—Ç—å –∫ ${c}, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å ${x+c}?`;break;default:const ra=Math.floor(Math.random()*50)+10;const rb=Math.floor(Math.random()*30)+5;question=`${ra} + ${rb} = ?`;answer=ra+rb;hint='–ü–æ—Å—á–∏—Ç–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ';}currentQuestion={question,answer,hint,type};document.getElementById('question').textContent=question;document.getElementById('questionType').textContent=type;updateProgress();}
        function checkAnswer(){const userAnswer=parseFloat(document.getElementById('answerInput').value);const feedback=document.getElementById('feedback');if(isNaN(userAnswer)){feedback.className='feedback incorrect';feedback.innerHTML='‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!';return;}questionsInSession++;totalQuestions++;const isCorrect=Math.abs(userAnswer-currentQuestion.answer)<0.01;if(isCorrect){correctAnswers++;streak++;const points=hintsUsed===0?10:5;totalScore+=points;feedback.className='feedback correct';feedback.innerHTML=`‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–æ!<br>+${points} –±–∞–ª–ª–æ–≤${streak>=3?'<br>üî• –°–µ—Ä–∏—è: '+streak:''}`;checkAchievements();}else{streak=0;feedback.className='feedback incorrect';feedback.innerHTML=`‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${currentQuestion.answer}<br>–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!`;}updateDisplay();saveProgress();}
        function showHint(){if(hintsUsed>=1){document.getElementById('hintArea').innerHTML='<div class="hint">üí° –¢—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–æ–¥—Å–∫–∞–∑–∫—É!</div>';return;}hintsUsed++;document.getElementById('hintArea').innerHTML=`<div class="hint">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: ${currentQuestion.hint}</div>`;}
        function nextQuestion(){generateQuestion();}
        function updateProgress(){const progress=questionsInSession>0?(correctAnswers/questionsInSession*100):0;document.getElementById('progressFill').style.width=progress+'%';document.getElementById('progressFill').textContent=Math.round(progress)+'%';}
        function updateDisplay(){document.getElementById('totalScore').textContent=totalScore;document.getElementById('sessionScore').textContent=`${correctAnswers}/${questionsInSession}`;document.getElementById('streakDisplay').textContent=streak+'üî•';}
        function checkAchievements(){if(totalQuestions>=1)unlockAchievement('ach1');if(correctAnswers>=10)unlockAchievement('ach2');if(streak>=5)unlockAchievement('ach3');if(totalQuestions>=50)unlockAchievement('ach4');if(totalScore>=500)unlockAchievement('ach5');}
        function unlockAchievement(id){const ach=document.getElementById(id);if(!ach.classList.contains('unlocked')){ach.classList.add('unlocked');}}
        function backToTopics(){document.getElementById('quizArea').style.display='none';document.getElementById('topicSelection').style.display='block';}
        function backToGrades(){document.getElementById('topicSelection').style.display='none';document.getElementById('gradeSelection').style.display='block';}
        document.getElementById('answerInput').addEventListener('keypress',function(e){if(e.key==='Enter'){checkAnswer();}});
        loadProgress();
    </script>
</body>
</html>
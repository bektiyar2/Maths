<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ 1-7 –∫–ª–∞—Å—Å–æ–≤ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö">
    <meta name="theme-color" content="#0077b6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –†–ö">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ - –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #00a8cc 0%, #0077b6 50%, #023e8a 100%); 
            min-height: 100vh; 
            padding: 20px; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 20px; 
            padding: 30px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
        }
        .header { text-align: center; margin-bottom: 30px; }
        h1 { color: #0077b6; font-size: 2.2em; margin-bottom: 10px; }
        .subtitle { color: #666; font-size: 1.1em; }
        .name-input-section { 
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); 
            padding: 20px; 
            border-radius: 12px; 
            margin-bottom: 20px; 
            text-align: center; 
        }
        .name-input { 
            padding: 12px 20px; 
            font-size: 1.1em; 
            border: 2px solid #0077b6; 
            border-radius: 8px; 
            width: 300px; 
            max-width: 100%; 
        }
        .tabs { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 20px; 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        .tab { 
            padding: 12px 24px; 
            border: 2px solid #0077b6; 
            background: white; 
            color: #0077b6; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: bold; 
            transition: all 0.3s; 
        }
        .tab.active { background: #0077b6; color: white; }
        .tab:hover { transform: translateY(-2px); }
        .stats-section { display: none; }
        .stats-section.active { display: block; }
        .leaderboard { 
            background: #f8f9fa; 
            border-radius: 12px; 
            padding: 20px; 
            margin-bottom: 20px; 
        }
        .leaderboard table { width: 100%; border-collapse: collapse; }
        .leaderboard th { 
            background: #0077b6; 
            color: white; 
            padding: 12px; 
            text-align: left; 
        }
        .leaderboard td { padding: 10px; border-bottom: 1px solid #ddd; }
        .leaderboard tr:hover { background: #f0f9ff; }
        .medal { font-size: 1.5em; }
        .grade-selection { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
            gap: 15px; 
            margin-bottom: 30px; 
        }
        .grade-btn { 
            padding: 20px; 
            border: 3px solid #0077b6; 
            background: white; 
            color: #0077b6; 
            border-radius: 12px; 
            cursor: pointer; 
            font-size: 1.2em; 
            font-weight: bold; 
            transition: all 0.3s; 
        }
        .grade-btn:hover { 
            background: #0077b6; 
            color: white; 
            transform: translateY(-3px); 
            box-shadow: 0 5px 15px rgba(0,119,182,0.3); 
        }
        .topic-selection { display: none; }
        .topic-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); 
            gap: 15px; 
            margin-bottom: 20px; 
        }
        .topic-btn { 
            position: relative;
            padding: 15px; 
            border: 2px solid #023e8a; 
            background: white; 
            color: #023e8a; 
            border-radius: 10px; 
            cursor: pointer; 
            font-size: 1em; 
            transition: all 0.3s; 
            text-align: left; 
        }
        .topic-btn:hover { 
            background: #023e8a; 
            color: white; 
            transform: translateX(5px); 
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin: 5px 0 10px 0;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169);
            border-radius: 5px;
            transition: width 0.5s ease;
            position: relative;
        }
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .topic-progress {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }
        .quiz-area { display: none; }
        .questions-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-bottom: 25px; 
        }
        .question-card { 
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); 
            padding: 25px; 
            border-radius: 15px; 
            border-left: 5px solid #0077b6; 
        }
        .question-number { 
            color: #0077b6; 
            font-size: 0.9em; 
            margin-bottom: 10px; 
            font-weight: bold; 
        }
        .question-text { 
            font-size: 1.2em; 
            color: #333; 
            margin-bottom: 15px; 
            line-height: 1.6; 
        }
        .answer-input { 
            width: 100%; 
            padding: 12px; 
            font-size: 1.1em; 
            border: 3px solid #ddd; 
            border-radius: 8px; 
            margin-bottom: 10px; 
            text-align: center; 
            transition: all 0.3s; 
        }
        .answer-input:focus { 
            outline: none; 
            border-color: #0077b6; 
            box-shadow: 0 0 10px rgba(0,119,182,0.2); 
        }
        .answer-input.correct { 
            border-color: #48bb78; 
            background: #c6f6d5; 
        }
        .answer-input.incorrect { 
            border-color: #f56565; 
            background: #fed7d7; 
        }
        .btn { 
            padding: 14px 35px; 
            font-size: 1.1em; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            margin: 5px; 
            transition: all 0.3s; 
            font-weight: bold; 
        }
        .check-btn { 
            background: linear-gradient(135deg, #0077b6 0%, #023e8a 100%); 
            color: white; 
        }
        .check-btn:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(0,119,182,0.3); 
        }
        .next-btn { 
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); 
            color: white; 
        }
        .back-btn { background: #6c757d; color: white; }
        .result-summary { 
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); 
            padding: 25px; 
            border-radius: 12px; 
            text-align: center; 
            font-size: 1.3em; 
            margin-bottom: 20px; 
        }
        .button-group { 
            display: flex; 
            justify-content: center; 
            flex-wrap: wrap; 
            gap: 10px; 
            margin: 20px 0; 
        }
        .install-prompt { 
            display: none; 
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); 
            color: white; 
            padding: 15px; 
            border-radius: 10px; 
            margin-bottom: 20px; 
            text-align: center; 
        }
        .install-btn { 
            background: white; 
            color: #38a169; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: 10px; 
        }
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f6e05e, #d69e2e);
            color: #744210;
            padding: 5px 10px;
            border-radius: 20px;
            margin: 2px;
            font-size: 0.9em;
        }
        .achievement-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ */
        .sources-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
        }
        
        .sources-grade-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .sources-grade-card:hover {
            border-color: #0077b6;
            box-shadow: 0 5px 15px rgba(0,119,182,0.1);
        }
        
        .sources-grade-title {
            color: #023e8a;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .sources-book-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .sources-book-icon {
            margin-right: 12px;
            font-size: 1.3em;
            color: #0077b6;
        }
        
        .sources-book-info {
            flex: 1;
        }
        
        .sources-book-authors {
            font-size: 0.9em;
            color: #666;
            margin-top: 4px;
        }
        
        .sources-link-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .sources-link-card {
            display: block;
            background: white;
            border: 2px solid #e0e0e0;
            padding: 18px;
            border-radius: 10px;
            text-decoration: none;
            color: #333;
            transition: all 0.3s;
        }
        
        .sources-link-card:hover {
            border-color: #0077b6;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,119,182,0.1);
        }
        
        .sources-link-icon {
            font-size: 1.8em;
            margin-bottom: 10px;
            color: #0077b6;
        }
        
        .sources-link-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #0077b6;
        }
        
        .sources-link-desc {
            font-size: 0.9em;
            color: #666;
            line-height: 1.4;
        }
        
        .sources-compliance {
            background: linear-gradient(135deg, #e8f5e9 0%, #d4edda 100%);
            border-left: 5px solid #48bb78;
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
        }
        
        .sources-compliance-title {
            color: #38a169;
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="installPrompt" class="install-prompt">
            <div>üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞!</div>
            <button class="install-btn" onclick="installApp()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
        </div>
        
        <div class="header">
            <h1>üéì –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</h1>
            <p class="subtitle">–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö</p>
            <div style="text-align: center; margin: 10px 0;">
                <button id="langToggle" onclick="toggleLanguage()" style="background: #f8f9fa; border: 2px solid #0077b6; padding: 5px 15px; border-radius: 20px; cursor: pointer;">
                    üá∞üáø “ö–∞–∑–∞“õ—à–∞
                </button>
            </div>
        </div>

        <div class="name-input-section">
            <label for="studentName" style="font-size: 1.1em; font-weight: bold; color: #0077b6; display: block; margin-bottom: 10px;">üë§ –í–≤–µ–¥–∏—Ç–µ –∏–º—è —É—á–µ–Ω–∏–∫–∞:</label>
            <input type="text" id="studentName" class="name-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–π–≥—É–ª—å">
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('practice')">üìù –ü—Ä–∞–∫—Ç–∏–∫–∞</button>
            <button class="tab" onclick="showTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="tab" onclick="showTab('achievements')">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
            <button class="tab" onclick="showTab('sources')">üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏</button>
        </div>

        <div id="statsSection" class="stats-section">
            <div class="leaderboard">
                <h2 style="color: #0077b6; margin-bottom: 20px;">üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
                <table id="leaderboardTable">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–º—è</th>
                            <th>–ë–∞–ª–ª—ã</th>
                            <th>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</th>
                            <th>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</th>
                            <th>–¢–æ—á–Ω–æ—Å—Ç—å</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody"></tbody>
                </table>
            </div>
        </div>

        <div id="achievementsSection" class="stats-section">
            <div class="leaderboard">
                <h2 style="color: #0077b6; margin-bottom: 20px;">üèÜ –í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div id="achievementsList" class="achievement-list"></div>
                <div id="noAchievements" style="text-align: center; padding: 20px; color: #666;">
                    –ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–µ–π–¥–∂–∏!
                </div>
            </div>
        </div>

        <div id="sourcesSection" class="stats-section">
            <div class="sources-section">
                <h2 style="color: #0077b6; margin-bottom: 25px;">üìö –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</h2>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #023e8a; margin-bottom: 20px; font-size: 1.3em;">üìñ –£—á–µ–±–Ω–∏–∫–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</h3>
                    
                    <div class="sources-grade-card">
                        <div class="sources-grade-title">1-4 –∫–ª–∞—Å—Å—ã</div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìò</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 1 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ë.–¢. –ê–ª–¥–∞–º–±–µ—Ä–≥–µ–Ω–æ–≤–∞, –ö.–ë. –ë–∞–π—à–æ–ª–∞–Ω–æ–≤–∞</div>
                            </div>
                        </div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìò</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 2 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ë.–¢. –ê–ª–¥–∞–º–±–µ—Ä–≥–µ–Ω–æ–≤–∞, –ö.–ë. –ë–∞–π—à–æ–ª–∞–Ω–æ–≤–∞</div>
                            </div>
                        </div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìò</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 3 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ë.–¢. –ê–ª–¥–∞–º–±–µ—Ä–≥–µ–Ω–æ–≤–∞, –ö.–ë. –ë–∞–π—à–æ–ª–∞–Ω–æ–≤–∞</div>
                            </div>
                        </div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìò</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 4 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ë.–¢. –ê–ª–¥–∞–º–±–µ—Ä–≥–µ–Ω–æ–≤–∞, –ö.–ë. –ë–∞–π—à–æ–ª–∞–Ω–æ–≤–∞</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sources-grade-card">
                        <div class="sources-grade-title">5-7 –∫–ª–∞—Å—Å—ã</div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìó</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 5 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ê.–ï. –ê–±—ã–ª–∫–∞—Å—ã–º–æ–≤–∞, –ò.–ë. –ë–µ–∫–±–æ–µ–≤, –ó.–ê. –ñ—É–º–∞–≥—É–ª–æ–≤–∞</div>
                            </div>
                        </div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìó</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 6 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ê.–ï. –ê–±—ã–ª–∫–∞—Å—ã–º–æ–≤–∞, –ö.–î. –®–æ–π—ã–Ω–±–µ—Ç–æ–≤, –ó.–ê. –ñ—É–º–∞–≥—É–ª–æ–≤–∞</div>
                            </div>
                        </div>
                        <div class="sources-book-item">
                            <div class="sources-book-icon">üìó</div>
                            <div class="sources-book-info">
                                <div style="font-weight: bold;">"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞" –¥–ª—è 7 –∫–ª–∞—Å—Å–∞</div>
                                <div class="sources-book-authors">–ê–≤—Ç–æ—Ä—ã: –ê.–ï. –ê–±—ã–ª–∫–∞—Å—ã–º–æ–≤–∞, –ö.–î. –®–æ–π—ã–Ω–±–µ—Ç–æ–≤, –ó.–ê. –ñ—É–º–∞–≥—É–ª–æ–≤–∞</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #023e8a; margin-bottom: 20px; font-size: 1.3em;">üìã –ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</h3>
                    
                    <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="font-weight: bold; color: #0077b6; margin-bottom: 10px;">–ì–û–°–û –†–ö (–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –æ–±—â–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è):</div>
                        <ul style="margin-top: 10px; padding-left: 20px; color: #555;">
                            <li style="margin-bottom: 5px;">–ì–û–°–û –†–ö 1.1.001-2009 "–ù–∞—á–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"</li>
                            <li style="margin-bottom: 5px;">–ì–û–°–û –†–ö 2.3.0.001-2010 "–û—Å–Ω–æ–≤–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"</li>
                            <li style="margin-bottom: 5px;">–ì–û–°–û –†–ö 2.3.0.002-2018 "–û–±—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"</li>
                        </ul>
                    </div>
                    
                    <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="font-weight: bold; color: #0077b6; margin-bottom: 10px;">–ü—Ä–∏–∫–∞–∑—ã –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—É–∫–∏ –†–ö:</div>
                        <ul style="margin-top: 10px; padding-left: 20px; color: #555;">
                            <li style="margin-bottom: 5px;">–ü—Ä–∏–∫–∞–∑ ‚Ññ 137 –æ—Ç 3 –∞–ø—Ä–µ–ª—è 2013 –≥–æ–¥–∞ "–û–± —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –¢–∏–ø–æ–≤—ã—Ö —É—á–µ–±–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º"</li>
                            <li style="margin-bottom: 5px;">–ü—Ä–∏–∫–∞–∑ ‚Ññ 348 –æ—Ç 29 –∏—é–Ω—è 2018 –≥–æ–¥–∞ "–û–± —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤—ã—Ö —É—á–µ–±–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤"</li>
                            <li style="margin-bottom: 5px;">–ü—Ä–∏–∫–∞–∑ ‚Ññ 182 –æ—Ç 30 –∞–ø—Ä–µ–ª—è 2020 –≥–æ–¥–∞ "–û –≤–Ω–µ—Å–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π"</li>
                        </ul>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="color: #023e8a; margin-bottom: 20px; font-size: 1.3em;">üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h3>
                    
                    <div class="sources-link-grid">
                        <a href="https://www.gov.kz/memleket/entities/edu" target="_blank" class="sources-link-card">
                            <div class="sources-link-icon">üåê</div>
                            <div class="sources-link-title">–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö</div>
                            <div class="sources-link-desc">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—É–∫–∏ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</div>
                        </a>
                        
                        <a href="https://www.nao.kz" target="_blank" class="sources-link-card">
                            <div class="sources-link-icon">üèõÔ∏è</div>
                            <div class="sources-link-title">–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–∫–∞–¥–µ–º–∏—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è</div>
                            <div class="sources-link-desc">–ò–º–µ–Ω–∏ –ò. –ê–ª—Ç—ã–Ω—Å–∞—Ä–∏–Ω–∞. –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</div>
                        </a>
                        
                        <a href="https://mektep.kz" target="_blank" class="sources-link-card">
                            <div class="sources-link-icon">üìö</div>
                            <div class="sources-link-title">–ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ "–ú–µ–∫—Ç–µ–ø"</div>
                            <div class="sources-link-desc">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ —É—á–µ–±–Ω–∏–∫–æ–≤ –∏ —É—á–µ–±–Ω—ã—Ö –ø–æ—Å–æ–±–∏–π</div>
                        </a>
                        
                        <a href="https://bilimal.kz" target="_blank" class="sources-link-card">
                            <div class="sources-link-icon">üíª</div>
                            <div class="sources-link-title">BilimAL –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç–∞–ª</div>
                            <div class="sources-link-desc">–û–Ω–ª–∞–π–Ω —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è —É—á–∞—â–∏—Ö—Å—è –∏ —É—á–∏—Ç–µ–ª–µ–π</div>
                        </a>
                    </div>
                </div>
                
                <div class="sources-compliance">
                    <div class="sources-compliance-title">üìã –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–µ</div>
                    <p style="color: #555; line-height: 1.6; margin: 0;">
                        –î–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å <strong>–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π 
                        —Å—Ä–µ–¥–Ω–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω</strong>. –í—Å–µ —Ç–µ–º—ã –∏ –∑–∞–¥–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 
                        —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º <strong>–ì–û–°–û –†–ö</strong> –∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —É—á–µ–±–Ω–∏–∫–∞—Ö, —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö 
                        –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—É–∫–∏ –†–ö –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –æ–±—â–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —à–∫–æ–ª–∞—Ö.
                    </p>
                </div>
            </div>
        </div>

        <div id="practiceSection" class="stats-section active">
            <div id="gradeSelection">
                <h2 style="text-align: center; color: #0077b6; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å:</h2>
                <div class="grade-selection">
                    <button class="grade-btn" onclick="selectGrade(1)">1<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(2)">2<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(3)">3<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(4)">4<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(5)">5<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(6)">6<br>–∫–ª–∞—Å—Å</button>
                    <button class="grade-btn" onclick="selectGrade(7)">7<br>–∫–ª–∞—Å—Å</button>
                </div>
            </div>

            <div id="topicSelection" class="topic-selection">
                <h2 style="text-align: center; color: #0077b6; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É:</h2>
                <div class="topic-grid" id="topicButtons"></div>
                <div style="text-align: center;">
                    <button class="btn back-btn" onclick="backToGrades()">‚Üê –ù–∞–∑–∞–¥ –∫ –∫–ª–∞—Å—Å–∞–º</button>
                </div>
            </div>

            <div id="quizArea" class="quiz-area">
                <div id="timerSection" style="text-align: center; margin-bottom: 15px; display: none;">
                    <div style="font-size: 1.2em; color: #0077b6; font-weight: bold;">
                        ‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏: <span id="timer">05:00</span>
                    </div>
                </div>
                <div class="result-summary" id="resultSummary"></div>
                <div class="questions-grid" id="questionsGrid"></div>
                <div class="button-group">
                    <button class="btn check-btn" onclick="checkAllAnswers()">‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ</button>
                    <button class="btn next-btn" onclick="generateNewSet()">–ù–æ–≤—ã–π –Ω–∞–±–æ—Ä ‚Üí</button>
                    <button class="btn" onclick="startTimedTest()" style="background: linear-gradient(135deg, #e67e22 0%, #d35400 100%); color: white;">
                        ‚è±Ô∏è –¢–µ—Å—Ç –Ω–∞ –≤—Ä–µ–º—è
                    </button>
                    <button class="btn back-btn" onclick="backToTopics()">‚Üê –ù–∞–∑–∞–¥ –∫ —Ç–µ–º–∞–º</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentGrade = 0;
        let currentTopic = '';
        let currentQuestions = [];
        let studentResults = {};
        let deferredPrompt;
        let timerInterval;
        let timeLeft = 300;
        let currentLanguage = 'ru';

        // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        const achievements = {
            'first_10': { name: '–ù–æ–≤–∏—á–æ–∫', desc: '–†–µ—à–µ–Ω–æ 10 –∑–∞–¥–∞—á', icon: 'ü•ö', threshold: 10 },
            'first_50': { name: '–£—á–µ–Ω–∏–∫', desc: '–†–µ—à–µ–Ω–æ 50 –∑–∞–¥–∞—á', icon: 'üê£', threshold: 50 },
            'first_100': { name: '–ú–∞—Ç–µ–º–∞—Ç–∏–∫', desc: '–†–µ—à–µ–Ω–æ 100 –∑–∞–¥–∞—á', icon: 'üê•', threshold: 100 },
            'accuracy_90': { name: '–¢–æ—á–Ω–æ—Å—Ç—å', desc: '–¢–æ—á–Ω–æ—Å—Ç—å –≤—ã—à–µ 90%', icon: 'üéØ', threshold: 0.9 },
            'all_correct': { name: '–ò–¥–µ–∞–ª—å–Ω–æ', desc: '–í—Å–µ –æ—Ç–≤–µ—Ç—ã –≤–µ—Ä–Ω—ã –≤ —Ç–µ—Å—Ç–µ', icon: '‚≠ê', threshold: 1 },
            'speed_demon': { name: '–°–∫–æ—Ä–æ—Å—Ç—å', desc: '–†–µ—à–∏—Ç—å 5 –∑–∞–¥–∞—á –∑–∞ –º–∏–Ω—É—Ç—É', icon: '‚ö°', threshold: 5 }
        };

        let userAchievements = {};

        // –ü–µ—Ä–µ–≤–æ–¥—ã
        const translations = {
            ru: {
                title: 'üéì –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞',
                subtitle: '–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–ö',
                enterName: 'üë§ –í–≤–µ–¥–∏—Ç–µ –∏–º—è —É—á–µ–Ω–∏–∫–∞:',
                practice: 'üìù –ü—Ä–∞–∫—Ç–∏–∫–∞',
                stats: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                achievements: 'üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
                sources: 'üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏',
                leaderboard: 'üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤',
                chooseGrade: '–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å:',
                chooseTopic: '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É:',
                backToGrades: '‚Üê –ù–∞–∑–∞–¥ –∫ –∫–ª–∞—Å—Å–∞–º',
                backToTopics: '‚Üê –ù–∞–∑–∞–¥ –∫ —Ç–µ–º–∞–º',
                checkAll: '‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ',
                newSet: '–ù–æ–≤—ã–π –Ω–∞–±–æ—Ä ‚Üí',
                timedTest: '‚è±Ô∏è –¢–µ—Å—Ç –Ω–∞ –≤—Ä–µ–º—è',
                installText: 'üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞!',
                installBtn: '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ',
                yourAchievements: 'üèÜ –í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è',
                noAchievements: '–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π. –†–µ—à–∞–π—Ç–µ –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–µ–π–¥–∂–∏!'
            },
            kk: {
                title: 'üéì –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞',
                subtitle: '–ë—ñ–ª—ñ–º –º–∏–Ω–∏—Å—Ç—Ä–ª—ñ–≥—ñ–Ω—ñ“£ –±–∞“ì–¥–∞—Ä–ª–∞–º–∞—Å—ã',
                enterName: 'üë§ –û“õ—É—à—ã–Ω—ã“£ –∞—Ç—ã–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑:',
                practice: 'üìù –ü—Ä–∞–∫—Ç–∏–∫–∞',
                stats: 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞',
                achievements: 'üèÜ –ñ–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä',
                sources: 'üìö –î–µ—Ä–µ–∫–∫”©–∑–¥–µ—Ä',
                leaderboard: 'üèÜ –ö”©—à–±–∞—Å—à—ã–ª–∞—Ä –∫–µ—Å—Ç–µ—Å—ñ',
                chooseGrade: '–°—ã–Ω—ã–ø—Ç—ã —Ç–∞“£–¥–∞“£—ã–∑:',
                chooseTopic: '–¢–∞“õ—ã—Ä—ã–ø—Ç—ã —Ç–∞“£–¥–∞“£—ã–∑:',
                backToGrades: '‚Üê –°—ã–Ω—ã–ø—Ç–∞—Ä“ì–∞ –æ—Ä–∞–ª—É',
                backToTopics: '‚Üê –¢–∞“õ—ã—Ä—ã–ø—Ç–∞—Ä“ì–∞ –æ—Ä–∞–ª—É',
                checkAll: '‚úì –ë–∞—Ä–ª—ã“ì—ã–Ω —Ç–µ–∫—Å–µ—Ä—É',
                newSet: '–ñ–∞“£–∞ –∂–∏—ã–Ω ‚Üí',
                timedTest: '‚è±Ô∏è –£–∞“õ—ã—Ç–ø–µ–Ω —Ç–µ—Å—Ç',
                installText: 'üì± “ö–æ–ª–∂–µ—Ç—ñ–º–¥—ñ–ª—ñ–∫ “Ø—à—ñ–Ω –±–∞—Å—Ç—ã —ç–∫—Ä–∞–Ω“ì–∞ “õ–æ—Å—ã–º—à–∞–Ω—ã –æ—Ä–Ω–∞—Ç—ã“£—ã–∑!',
                installBtn: '“ö–æ—Å—ã–º—à–∞–Ω—ã –æ—Ä–Ω–∞—Ç—É',
                yourAchievements: 'üèÜ –°—ñ–∑–¥—ñ“£ –∂–µ—Ç—ñ—Å—Ç—ñ–∫—Ç–µ—Ä—ñ“£—ñ–∑',
                noAchievements: '”ò–ª—ñ –∂–µ—Ç—ñ—Å—Ç—ñ–∫ –∂–æ“õ. –ë–µ–ª–≥—ñ–ª–µ—Ä –∞–ª—É “Ø—à—ñ–Ω –µ—Å–µ–ø—Ç–µ—Ä–¥—ñ —à–µ—à—ñ“£—ñ–∑!'
            }
        };

        // –¢–µ–º–∞—Ç–∏–∫–∞ –ø–æ –∫–ª–∞—Å—Å–∞–º
        const topics = {
            1: ['–°–∞–Ω–¥–∞—Ä 1-10', '1-10 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ “õ–æ—Å—É', '1-10 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ –∞–∑–∞–π—Ç—É', '11-20 —Å–∞–Ω–¥–∞—Ä—ã', '–°–∞–Ω–¥–∞—Ä–¥—ã —Å–∞–ª—ã—Å—Ç—ã—Ä—É', '–°–∞–Ω–¥–∞—Ä–¥—ã“£ “õ“±—Ä–∞–º—ã', '–õ–æ–≥–∏–∫–∞–ª—ã“õ –µ—Å–µ–ø—Ç–µ—Ä'],
            2: ['–°–∞–Ω–¥–∞—Ä 1-100', '1-20 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ “õ–æ—Å—É –∂”ô–Ω–µ –∞–∑–∞–π—Ç—É', '1-100 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ “õ–æ—Å—É –∂”ô–Ω–µ –∞–∑–∞–π—Ç—É', '2, 3 –∫–µ—Å—Ç–µ—Å—ñ –±–æ–π—ã–Ω—à–∞ –∫”©–±–µ–π—Ç—É', '2, 3-–∫–µ –±”©–ª—É', '–ú”ô—Ç—ñ–Ω–¥—ñ–∫ –µ—Å–µ–ø—Ç–µ—Ä', '–õ–æ–≥–∏–∫–∞–ª—ã“õ –µ—Å–µ–ø—Ç–µ—Ä'],
            3: ['–°–∞–Ω–¥–∞—Ä 1000-“ì–∞ –¥–µ–π—ñ–Ω', '“Æ—à —Ç–∞“£–±–∞–ª—ã —Å–∞–Ω–¥–∞—Ä–¥—ã “õ–æ—Å—É –∂”ô–Ω–µ –∞–∑–∞–π—Ç—É', '–ö”©–±–µ–π—Ç—É –∫–µ—Å—Ç–µ—Å—ñ (—Ç–æ–ª—ã“õ)', '–ö–µ—Å—Ç–µ—Å—ñ–∑ –∫”©–±–µ–π—Ç—É', '“ö–∞–ª–¥—ã“õ–ø–µ–Ω –±”©–ª—É', '–ë”©–ª—à–µ–∫—Ç–µ—Ä –º–µ–Ω “Ø–ª–µ—Å—Ç–µ—Ä', '“ö–æ–∑“ì–∞–ª—ã—Å“õ–∞ –µ—Å–µ–ø—Ç–µ—Ä', '–õ–æ–≥–∏–∫–∞ –∂”ô–Ω–µ —Ä–µ–±—É—Å—Ç–∞—Ä'],
            4: ['–ö”©–ø —Ç–∞“£–±–∞–ª—ã —Å–∞–Ω–¥–∞—Ä', '–¢”©—Ä—Ç –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞–ª—ã“õ –∞–º–∞–ª', '–ñ–∞–∑—ã–º–µ–Ω –∫”©–±–µ–π—Ç—É', '–ñ–∞–∑—ã–º–µ–Ω –±”©–ª—É', '–ñ—ã–ª–¥–∞–º–¥—ã“õ, —É–∞“õ—ã—Ç, “õ–∞—à—ã“õ—Ç—ã“õ', '–ê—É–¥–∞–Ω –∂”ô–Ω–µ –ø–µ—Ä–∏–º–µ—Ç—Ä', '–ë”©–ª—à–µ–∫—Ç–µ—Ä', '–õ–æ–≥–∏–∫–∞–ª—ã“õ –µ—Å–µ–ø—Ç–µ—Ä'],
            5: ['–ù–∞—Ç—É—Ä–∞–ª —Å–∞–Ω–¥–∞—Ä', '–ñ–∞–π –±”©–ª—à–µ–∫—Ç–µ—Ä', '–ë”©–ª—à–µ–∫—Ç–µ—Ä–¥—ñ “õ–æ—Å—É –∂”ô–Ω–µ –∞–∑–∞–π—Ç—É', '–ë”©–ª—à–µ–∫—Ç–µ—Ä–¥—ñ –∫”©–±–µ–π—Ç—É –∂”ô–Ω–µ –±”©–ª—É', '–û–Ω–¥—ã“õ –±”©–ª—à–µ–∫—Ç–µ—Ä', '–ü–∞–π—ã–∑–¥–∞—Ä', '–¢–µ“£–¥–µ—É–ª–µ—Ä', '–ê—É–¥–∞–Ω –∂”ô–Ω–µ –∫”©–ª–µ–º', '–õ–æ–≥–∏–∫–∞'],
            6: ['–°–∞–Ω–¥–∞—Ä–¥—ã“£ –±”©–ª—ñ–Ω–≥—ñ—à—Ç—ñ–≥—ñ', '–†–∞—Ü–∏–æ–Ω–∞–ª —Å–∞–Ω–¥–∞—Ä', '–°–∞–Ω–Ω—ã“£ –º–æ–¥—É–ª—ñ', '–†–∞—Ü–∏–æ–Ω–∞–ª —Å–∞–Ω–¥–∞—Ä–¥—ã —Å–∞–ª—ã—Å—Ç—ã—Ä—É', '–†–∞—Ü–∏–æ–Ω–∞–ª —Å–∞–Ω–¥–∞—Ä–º–µ–Ω –∞–º–∞–ª–¥–∞—Ä', '–ü—Ä–æ–ø–æ—Ä—Ü–∏—è–ª–∞—Ä', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–ª—ã“õ –∂–∞–∑—ã“õ—Ç—ã“õ', '–õ–æ–≥–∏–∫–∞–ª—ã“õ –µ—Å–µ–ø—Ç–µ—Ä'],
            7: ['–ê–ª–≥–µ–±—Ä–∞–ª—ã“õ ”©—Ä–Ω–µ–∫—Ç–µ—Ä', '–°—ã–∑—ã“õ—Ç—ã“õ —Ç–µ“£–¥–µ—É–ª–µ—Ä', '–î”ô—Ä–µ–∂–µ–ª–µ—Ä', '–ë—ñ—Ä–º“Ø—à–µ–ª–µ—Ä', '–ö”©–ø–º“Ø—à–µ–ª–µ—Ä', '“ö—ã—Å“õ–∞—Ä—Ç—ã–ª“ì–∞–Ω –∫”©–±–µ–π—Ç—É —Ñ–æ—Ä–º—É–ª–∞–ª–∞—Ä—ã', '–¢–µ“£–¥–µ—É–ª–µ—Ä –∂“Ø–π–µ—Å—ñ', '–õ–æ–≥–∏–∫–∞–ª—ã“õ –µ—Å–µ–ø—Ç–µ—Ä']
        };

        const topicsRu = {
            1: ['–ß–∏—Å–ª–∞ 1-10', '–°–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10', '–í—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10', '–ß–∏—Å–ª–∞ 11-20', '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–µ–ª', '–°–æ—Å—Ç–∞–≤ —á–∏—Å–µ–ª', '–ó–∞–¥–∞—á–∏ –Ω–∞ –ª–æ–≥–∏–∫—É'],
            2: ['–ß–∏—Å–ª–∞ 1-100', '–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 20', '–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 100', '–¢–∞–±–ª–∏—Ü–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞ 2, 3', '–î–µ–ª–µ–Ω–∏–µ –Ω–∞ 2, 3', '–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏', '–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏'],
            3: ['–ß–∏—Å–ª–∞ –¥–æ 1000', '–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ —Ç—Ä—ë—Ö–∑–Ω–∞—á–Ω—ã—Ö', '–¢–∞–±–ª–∏—Ü–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è (–≤—Å—è)', '–í–Ω–µ—Ç–∞–±–ª–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ', '–î–µ–ª–µ–Ω–∏–µ —Å –æ—Å—Ç–∞—Ç–∫–æ–º', '–î–æ–ª–∏ –∏ –¥—Ä–æ–±–∏', '–ó–∞–¥–∞—á–∏ –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ', '–õ–æ–≥–∏–∫–∞ –∏ —Ä–µ–±—É—Å—ã'],
            4: ['–ú–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã–µ —á–∏—Å–ª–∞', '–ß–µ—Ç—ã—Ä–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è', '–ü–∏—Å—å–º–µ–Ω–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ', '–ü–∏—Å—å–º–µ–Ω–Ω–æ–µ –¥–µ–ª–µ–Ω–∏–µ', '–°–∫–æ—Ä–æ—Å—Ç—å, –≤—Ä–µ–º—è, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ', '–ü–ª–æ—â–∞–¥—å –∏ –ø–µ—Ä–∏–º–µ—Ç—Ä', '–î—Ä–æ–±–∏', '–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏'],
            5: ['–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞', '–û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –¥—Ä–æ–±–∏', '–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –¥—Ä–æ–±–µ–π', '–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ –¥—Ä–æ–±–µ–π', '–î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏', '–ü—Ä–æ—Ü–µ–Ω—Ç—ã', '–£—Ä–∞–≤–Ω–µ–Ω–∏—è', '–ü–ª–æ—â–∞–¥—å –∏ –æ–±—ä—ë–º', '–õ–æ–≥–∏–∫–∞'],
            6: ['–î–µ–ª–∏–º–æ—Å—Ç—å —á–∏—Å–µ–ª', '–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —á–∏—Å–ª–∞', '–ú–æ–¥—É–ª—å —á–∏—Å–ª–∞', '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª', '–î–µ–π—Å—Ç–≤–∏—è —Å —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏', '–ü—Ä–æ–ø–æ—Ä—Ü–∏–∏', '–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å', '–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏'],
            7: ['–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è', '–õ–∏–Ω–µ–π–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è', '–°—Ç–µ–ø–µ–Ω–∏', '–û–¥–Ω–æ—á–ª–µ–Ω—ã', '–ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã', '–§–æ—Ä–º—É–ª—ã —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è', '–°–∏—Å—Ç–µ–º—ã —É—Ä–∞–≤–Ω–µ–Ω–∏–π', '–ó–∞–¥–∞—á–∏ –Ω–∞ –ª–æ–≥–∏–∫—É']
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            loadResults();
            loadAchievements();
            updateLanguage();
        }

        // PWA Installation
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installPrompt').style.display = 'block';
        });
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').style.display = 'none';
                });
            }
        }
        
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(function(registration) {
                console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
            }).catch(function(err) {
                console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', err);
            });
        }

        // –Ø–∑—ã–∫
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ru' ? 'kk' : 'ru';
            updateLanguage();
        }

        function updateLanguage() {
            const lang = translations[currentLanguage];
            const btn = document.getElementById('langToggle');
            
            document.querySelector('h1').textContent = lang.title;
            document.querySelector('.subtitle').textContent = lang.subtitle;
            document.querySelector('label[for="studentName"]').innerHTML = lang.enterName;
            
            const tabs = document.querySelectorAll('.tab');
            tabs[0].textContent = lang.practice;
            tabs[1].textContent = lang.stats;
            tabs[2].textContent = lang.achievements;
            tabs[3].textContent = lang.sources;
            
            document.querySelector('.leaderboard h2').textContent = lang.leaderboard;
            document.querySelector('#gradeSelection h2').textContent = lang.chooseGrade;
            document.querySelector('#topicSelection h2').textContent = lang.chooseTopic;
            document.querySelector('button[onclick="backToGrades()"]').textContent = lang.backToGrades;
            document.querySelector('button[onclick="backToTopics()"]').textContent = lang.backToTopics;
            document.querySelector('button[onclick="checkAllAnswers()"]').textContent = lang.checkAll;
            document.querySelector('button[onclick="generateNewSet()"]').textContent = lang.newSet;
            document.querySelector('button[onclick="startTimedTest()"]').textContent = lang.timedTest;
            document.querySelector('#installPrompt div').textContent = lang.installText;
            document.querySelector('.install-btn').textContent = lang.installBtn;
            
            btn.textContent = currentLanguage === 'ru' ? 'üá∞üáø “ö–∞–∑–∞“õ—à–∞' : 'üá∑üá∫ –†—É—Å—Å–∫–∏–π';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–º—ã, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç –≤—ã–±–æ—Ä —Ç–µ–º—ã
            if (currentGrade > 0) {
                updateTopicButtons();
            }
        }

        function updateTopicButtons() {
            const topicButtons = document.getElementById('topicButtons');
            if (!topicButtons || topicButtons.innerHTML === '') return;
            
            const name = document.getElementById('studentName').value.trim() || '–£—á–µ–Ω–∏–∫';
            const studentData = studentResults[name] || {};
            const currentTopics = currentLanguage === 'ru' ? topicsRu[currentGrade] : topics[currentGrade];
            
            topicButtons.innerHTML = '';
            
            currentTopics.forEach((topic, index) => {
                const btn = document.createElement('button');
                btn.className = 'topic-btn';
                
                const progressKey = `grade${currentGrade}_topic${index}`;
                const progress = studentData[progressKey] || 0;
                const progressPercent = Math.min(progress * 10, 100);
                
                btn.innerHTML = `
                    <div style="font-weight: bold;">${topic}</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progressPercent}%"></div>
                    </div>
                    <div class="topic-progress">${progress} –∏–∑ 10</div>
                `;
                
                btn.onclick = () => {
                    if (!studentResults[name]) {
                        studentResults[name] = {};
                    }
                    studentResults[name].currentTopicKey = progressKey;
                    selectTopic(currentLanguage === 'ru' ? topicsRu[currentGrade][index] : topic);
                };
                
                topicButtons.appendChild(btn);
            });
        }

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 300;
            document.getElementById('timerSection').style.display = 'block';
            
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    checkAllAnswers();
                    alert('‚è∞ –í—Ä–µ–º—è –≤—ã—à–ª–æ! –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç—ã...');
                }
                
                if (timeLeft < 60) {
                    document.getElementById('timer').style.color = '#f56565';
                }
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
            document.getElementById('timerSection').style.display = 'none';
        }

        function startTimedTest() {
            if (confirm('–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –Ω–∞ –≤—Ä–µ–º—è? –£ –≤–∞—Å –±—É–¥–µ—Ç 5 –º–∏–Ω—É—Ç –Ω–∞ 4 –∑–∞–¥–∞—á–∏.')) {
                startTimer();
                generateNewSet();
            }
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function showTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.stats-section').forEach(s => s.classList.remove('active'));
            
            const tabMap = {
                'practice': () => {
                    document.querySelector('.tab:nth-child(1)').classList.add('active');
                    document.getElementById('practiceSection').classList.add('active');
                },
                'stats': () => {
                    document.querySelector('.tab:nth-child(2)').classList.add('active');
                    document.getElementById('statsSection').classList.add('active');
                    updateLeaderboard();
                },
                'achievements': () => {
                    document.querySelector('.tab:nth-child(3)').classList.add('active');
                    document.getElementById('achievementsSection').classList.add('active');
                    showAchievements();
                },
                'sources': () => {
                    document.querySelector('.tab:nth-child(4)').classList.add('active');
                    document.getElementById('sourcesSection').classList.add('active');
                }
            };
            
            if (tabMap[tab]) {
                tabMap[tab]();
            }
        }

        function showAchievements() {
            const name = document.getElementById('studentName').value.trim();
            const list = document.getElementById('achievementsList');
            const noAch = document.getElementById('noAchievements');
            
            list.innerHTML = '';
            
            if (name && userAchievements[name]) {
                userAchievements[name].forEach(achId => {
                    const ach = achievements[achId];
                    const badge = document.createElement('div');
                    badge.className = 'achievement-badge';
                    badge.innerHTML = `${ach.icon} ${ach.name}`;
                    badge.title = ach.desc;
                    list.appendChild(badge);
                });
                
                noAch.style.display = userAchievements[name].length > 0 ? 'none' : 'block';
            } else {
                noAch.style.display = 'block';
            }
        }

        // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
        function loadResults() {
            const saved = localStorage.getItem('studentResults');
            if (saved) {
                studentResults = JSON.parse(saved);
            }
        }

        function saveResults() {
            localStorage.setItem('studentResults', JSON.stringify(studentResults));
        }

        function loadAchievements() {
            const saved = localStorage.getItem('userAchievements');
            if (saved) {
                userAchievements = JSON.parse(saved);
            }
        }

        function saveAchievements() {
            localStorage.setItem('userAchievements', JSON.stringify(userAchievements));
        }

        // –õ–∏–¥–µ—Ä–±–æ—Ä–¥
        function updateLeaderboard() {
            const tbody = document.getElementById('leaderboardBody');
            tbody.innerHTML = '';
            
            const students = Object.entries(studentResults).map(([name, data]) => ({
                name,
                score: data.totalScore || 0,
                correct: data.totalCorrect || 0,
                total: data.totalQuestions || 0,
                accuracy: data.totalQuestions > 0 ? Math.round((data.totalCorrect / data.totalQuestions) * 100) : 0
            })).sort((a, b) => b.score - a.score);
            
            students.forEach((student, index) => {
                const row = tbody.insertRow();
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                const medal = index < 3 ? medals[index] : (index + 1) + '.';
                
                row.innerHTML = `
                    <td><span class="medal">${medal}</span></td>
                    <td>${student.name}</td>
                    <td><strong>${student.score}</strong></td>
                    <td>${student.correct}</td>
                    <td>${student.total}</td>
                    <td>${student.accuracy}%</td>
                `;
            });
            
            if (students.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –ù–∞—á–Ω–∏—Ç–µ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏!</td></tr>';
            }
        }

        // –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ –∏ —Ç–µ–º—ã
        function selectGrade(grade) {
            currentGrade = grade;
            document.getElementById('gradeSelection').style.display = 'none';
            document.getElementById('topicSelection').style.display = 'block';
            updateTopicButtons();
        }

        function selectTopic(topic) {
            currentTopic = topic;
            document.getElementById('topicSelection').style.display = 'none';
            document.getElementById('quizArea').style.display = 'block';
            generateNewSet();
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤
        function generateNewSet() {
            currentQuestions = [];
            for (let i = 0; i < 4; i++) {
                currentQuestions.push(generateQuestion());
            }
            renderQuestions();
            document.getElementById('resultSummary').innerHTML = '';
        }

        function generateQuestion() {
            let question, answer, type = '–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞';
            
            if (currentTopic.includes('–ª–æ–≥–∏–∫') || currentTopic.includes('—Ä–µ–±—É—Å') || currentTopic.includes('–õ–æ–≥–∏–∫–∞')) {
                return generateLogicQuestion();
            }
            
            const topicId = getTopicId(currentTopic);
            
            switch(topicId) {
                case 'numbers_1_10':
                case 'addition_10':
                    const a1 = Math.floor(Math.random() * 9) + 1;
                    const b1 = Math.floor(Math.random() * (10 - a1)) + 1;
                    question = `${a1} + ${b1}`;
                    answer = a1 + b1;
                    break;
                    
                case 'subtraction_10':
                    const a2 = Math.floor(Math.random() * 9) + 2;
                    const b2 = Math.floor(Math.random() * a2) + 1;
                    question = `${a2} - ${b2}`;
                    answer = a2 - b2;
                    break;
                    
                case 'comparison':
                    const n1 = Math.floor(Math.random() * 20) + 1;
                    const n2 = Math.floor(Math.random() * 20) + 1;
                    question = `–ë–æ–ª—å—à–µ–µ –∏–∑ ${n1} –∏ ${n2}`;
                    answer = Math.max(n1, n2);
                    type = '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ';
                    break;
                    
                case 'multiplication_table':
                    const mult = currentGrade <= 2 ? [2, 3][Math.floor(Math.random() * 2)] : Math.floor(Math.random() * 8) + 2;
                    const num = Math.floor(Math.random() * 9) + 2;
                    question = `${mult} √ó ${num}`;
                    answer = mult * num;
                    break;
                    
                case 'division':
                    const div = currentGrade <= 2 ? [2, 3][Math.floor(Math.random() * 2)] : Math.floor(Math.random() * 7) + 2;
                    const res = Math.floor(Math.random() * 9) + 2;
                    question = `${div * res} √∑ ${div}`;
                    answer = res;
                    break;
                    
                case 'word_problems':
                    const appleCount = Math.floor(Math.random() * 10) + 5;
                    const given = Math.floor(Math.random() * 3) + 1;
                    const boys = Math.floor(Math.random() * 10) + 15;
                    const girls = Math.floor(Math.random() * 10) + 15;
                    
                    const stories = [
                        {q: `–£ –ê—Å–µ–ª—å ${appleCount} —è–±–ª–æ–∫. –û–Ω–∞ –¥–∞–ª–∞ ${given}. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?`, a: appleCount - given},
                        {q: `–í –∫–ª–∞—Å—Å–µ ${boys} –º–∞–ª—å—á–∏–∫–æ–≤ –∏ ${girls} –¥–µ–≤–æ—á–µ–∫. –í—Å–µ–≥–æ –¥–µ—Ç–µ–π?`, a: boys + girls},
                        {q: `–£ –ö–∞–Ω–∞—Ç–∞ ${Math.floor(Math.random() * 20) + 10} —Ç–µ–Ω–≥–µ. –û–Ω –∫—É–ø–∏–ª –∫–Ω–∏–≥—É –∑–∞ ${Math.floor(Math.random() * 15) + 5} —Ç–µ–Ω–≥–µ. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?`, a: (Math.floor(Math.random() * 20) + 10) - (Math.floor(Math.random() * 15) + 5)}
                    ];
                    const story = stories[Math.floor(Math.random() * stories.length)];
                    question = story.q;
                    answer = story.a;
                    type = '–¢–µ–∫—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞';
                    break;
                    
                case 'decimal_fractions':
                    const d1 = (Math.floor(Math.random() * 50) + 10) / 10;
                    const d2 = (Math.floor(Math.random() * 30) + 5) / 10;
                    question = `${d1} + ${d2}`;
                    answer = Math.round((d1 + d2) * 10) / 10;
                    break;
                    
                case 'percentages':
                    const base = [100, 200, 500][Math.floor(Math.random() * 3)];
                    const perc = [10, 20, 50][Math.floor(Math.random() * 3)];
                    question = `${perc}% –æ—Ç ${base}`;
                    answer = base * perc / 100;
                    break;
                    
                case 'equations':
                    const x = Math.floor(Math.random() * 20) + 1;
                    const c = Math.floor(Math.random() * 30) + 10;
                    question = `x + ${c} = ${x + c}, x = ?`;
                    answer = x;
                    type = '–£—Ä–∞–≤–Ω–µ–Ω–∏–µ';
                    break;
                    
                case 'area_perimeter':
                    const length = Math.floor(Math.random() * 10) + 3;
                    const width = Math.floor(Math.random() * 8) + 2;
                    if (Math.random() > 0.5) {
                        question = `–ü–ª–æ—â–∞–¥—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ ${length} √ó ${width}`;
                        answer = length * width;
                        type = '–ü–ª–æ—â–∞–¥—å';
                    } else {
                        question = `–ü–µ—Ä–∏–º–µ—Ç—Ä –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ ${length} √ó ${width}`;
                        answer = 2 * (length + width);
                        type = '–ü–µ—Ä–∏–º–µ—Ç—Ä';
                    }
                    break;
                    
                default:
                    const ra = Math.floor(Math.random() * 50) + 10;
                    const rb = Math.floor(Math.random() * 30) + 5;
                    question = `${ra} + ${rb}`;
                    answer = ra + rb;
            }
            
            return { question, answer, type };
        }

        function getTopicId(topic) {
            const map = {
                '–ß–∏—Å–ª–∞ 1-10': 'numbers_1_10',
                '–°–∞–Ω–¥–∞—Ä 1-10': 'numbers_1_10',
                '–°–ª–æ–∂–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10': 'addition_10',
                '1-10 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ “õ–æ—Å—É': 'addition_10',
                '–í—ã—á–∏—Ç–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10': 'subtraction_10',
                '1-10 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ –∞–∑–∞–π—Ç—É': 'subtraction_10',
                '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∏—Å–µ–ª': 'comparison',
                '–°–∞–Ω–¥–∞—Ä–¥—ã —Å–∞–ª—ã—Å—Ç—ã—Ä—É': 'comparison',
                '–¢–∞–±–ª–∏—Ü–∞ —É–º–Ω–æ–∂–µ–Ω–∏—è': 'multiplication_table',
                '–ö”©–±–µ–π—Ç—É –∫–µ—Å—Ç–µ—Å—ñ': 'multiplication_table',
                '–î–µ–ª–µ–Ω–∏–µ': 'division',
                '–ë”©–ª—É': 'division',
                '–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏': 'word_problems',
                '–ú”ô—Ç—ñ–Ω–¥—ñ–∫ –µ—Å–µ–ø—Ç–µ—Ä': 'word_problems',
                '–î–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏': 'decimal_fractions',
                '–û–Ω–¥—ã“õ –±”©–ª—à–µ–∫—Ç–µ—Ä': 'decimal_fractions',
                '–ü—Ä–æ—Ü–µ–Ω—Ç—ã': 'percentages',
                '–ü–∞–π—ã–∑–¥–∞—Ä': 'percentages',
                '–£—Ä–∞–≤–Ω–µ–Ω–∏—è': 'equations',
                '–¢–µ“£–¥–µ—É–ª–µ—Ä': 'equations',
                '–ü–ª–æ—â–∞–¥—å –∏ –ø–µ—Ä–∏–º–µ—Ç—Ä': 'area_perimeter',
                '–ê—É–¥–∞–Ω –∂”ô–Ω–µ –ø–µ—Ä–∏–º–µ—Ç—Ä': 'area_perimeter'
            };
            return map[topic] || 'default';
        }

        function generateLogicQuestion() {
            const logicQuestions = [
                { question: '–£ –ê–π–≥—É–ª—å 2 —è–±–ª–æ–∫–∞. –£ –ê—Å–µ–ª—å –Ω–∞ 3 –±–æ–ª—å—à–µ. –°–∫–æ–ª—å–∫–æ —É –ê—Å–µ–ª—å?', answer: 5 },
                { question: '–ü—Ä–æ–¥–æ–ª–∂–∏: 2, 4, 6, 8, ?', answer: 10 },
                { question: '–ï—Å–ª–∏ 5 + 3 = 8, —Ç–æ 8 - 3 = ?', answer: 5 },
                { question: '–£ –∫–æ—à–∫–∏ 4 –ª–∞–ø—ã. –£ –¥–≤—É—Ö –∫–æ—à–µ–∫ —Å–∫–æ–ª—å–∫–æ –ª–∞–ø?', answer: 8 },
                { question: '10 - 2 - 2 - 2 = ?', answer: 4 },
                { question: '–ü—Ä–æ–¥–æ–ª–∂–∏: 1, 3, 5, 7, ?', answer: 9 },
                { question: '–í –∫–æ—Ä–∑–∏–Ω–µ 10 —è–±–ª–æ–∫. –°—ä–µ–ª–∏ 3. –°–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–ª–æ—Å—å?', answer: 7 },
                { question: '3 + 3 + 3 = ?', answer: 9 },
                { question: '–ß—Ç–æ –ª–µ–≥—á–µ: 1 –∫–≥ –≤–∞—Ç—ã –∏–ª–∏ 1 –∫–≥ –∂–µ–ª–µ–∑–∞?', answer: 0 },
                { question: '–°–∫–æ–ª—å–∫–æ —É–≥–ª–æ–≤ —É –∫–≤–∞–¥—Ä–∞—Ç–∞?', answer: 4 }
            ];
            
            const q = logicQuestions[Math.floor(Math.random() * logicQuestions.length)];
            return { question: q.question, answer: q.answer, type: '–õ–æ–≥–∏–∫–∞' };
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–æ–ø—Ä–æ—Å–æ–≤
        function renderQuestions() {
            const grid = document.getElementById('questionsGrid');
            grid.innerHTML = '';
            
            currentQuestions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <div class="question-number">${q.type} ‚Ä¢ –ó–∞–¥–∞—á–∞ ${index + 1}</div>
                    <div class="question-text">${q.question} = ?</div>
                    <input type="number" step="0.1" class="answer-input" id="answer${index}" 
                           placeholder="–í–∞—à –æ—Ç–≤–µ—Ç"
                           oninput="checkSingleAnswer(${index})">
                    <div id="hint${index}" style="font-size: 0.9em; color: #666; margin-top: 5px; display: none;">
                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å -->
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
        function checkSingleAnswer(index) {
            const input = document.getElementById(`answer${index}`);
            const q = currentQuestions[index];
            const userAnswer = parseFloat(input.value);
            
            if (isNaN(userAnswer)) return;
            
            if (Math.abs(userAnswer - q.answer) < 0.01) {
                input.classList.remove('incorrect');
                input.classList.add('correct');
                input.title = "–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úì";
            } else {
                input.classList.remove('correct');
                input.classList.add('incorrect');
                input.title = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.answer}`;
            }
        }

        function checkAllAnswers() {
            const name = document.getElementById('studentName').value.trim();
            if (!name) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è —É—á–µ–Ω–∏–∫–∞!');
                return;
            }
            
            let correct = 0;
            let total = currentQuestions.length;
            
            currentQuestions.forEach((q, index) => {
                const input = document.getElementById(`answer${index}`);
                const userAnswer = parseFloat(input.value);
                
                if (!isNaN(userAnswer) && Math.abs(userAnswer - q.answer) < 0.01) {
                    correct++;
                    input.classList.add('correct');
                    input.classList.remove('incorrect');
                    input.title = "–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úì";
                } else {
                    input.classList.add('incorrect');
                    input.classList.remove('correct');
                    input.title = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${q.answer}`;
                }
            });
            
            const score = correct * 10;
            const accuracy = Math.round((correct / total) * 100);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            if (!studentResults[name]) {
                studentResults[name] = { totalScore: 0, totalCorrect: 0, totalQuestions: 0 };
            }
            
            studentResults[name].totalScore += score;
            studentResults[name].totalCorrect += correct;
            studentResults[name].totalQuestions += total;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Ç–µ–º–µ
            if (studentResults[name].currentTopicKey) {
                const topicKey = studentResults[name].currentTopicKey;
                if (!studentResults[name][topicKey]) {
                    studentResults[name][topicKey] = 0;
                }
                studentResults[name][topicKey] += correct;
            }
            
            saveResults();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            checkAchievements(name, correct, total, accuracy);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            const resultHTML = `
                <strong>${name}</strong>: ${correct} –∏–∑ ${total} (${accuracy}%) ‚Ä¢ +${score} –±–∞–ª–ª–æ–≤ 
                ${correct === total ? 'üéâ –û—Ç–ª–∏—á–Ω–æ!' : correct >= total/2 ? 'üëç –•–æ—Ä–æ—à–æ!' : 'üí™ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è!'}
            `;
            document.getElementById('resultSummary').innerHTML = resultHTML;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ –≤–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            if (document.getElementById('statsSection').classList.contains('active')) {
                updateLeaderboard();
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
            stopTimer();
        }

        // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        function checkAchievements(studentName, correctCount, totalQuestions, accuracy) {
            const studentData = studentResults[studentName];
            if (!studentData) return;
            
            const newAchievements = [];
            
            // –ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–¥–∞—á
            if (studentData.totalQuestions >= 10 && !(userAchievements[studentName] || []).includes('first_10')) {
                newAchievements.push('first_10');
            }
            if (studentData.totalQuestions >= 50 && !(userAchievements[studentName] || []).includes('first_50')) {
                newAchievements.push('first_50');
            }
            if (studentData.totalQuestions >= 100 && !(userAchievements[studentName] || []).includes('first_100')) {
                newAchievements.push('first_100');
            }
            
            // –ü–æ —Ç–æ—á–Ω–æ—Å—Ç–∏
            if (accuracy >= 90 && !(userAchievements[studentName] || []).includes('accuracy_90')) {
                newAchievements.push('accuracy_90');
            }
            
            // –ó–∞ –∏–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if (correctCount === totalQuestions && totalQuestions >= 4 && !(userAchievements[studentName] || []).includes('all_correct')) {
                newAchievements.push('all_correct');
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            if (newAchievements.length > 0) {
                if (!userAchievements[studentName]) {
                    userAchievements[studentName] = [];
                }
                
                newAchievements.forEach(achId => {
                    if (!userAchievements[studentName].includes(achId)) {
                        userAchievements[studentName].push(achId);
                    }
                });
                
                saveAchievements();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showAchievementNotification(newAchievements, studentName);
            }
        }

        function showAchievementNotification(achievementIds, studentName) {
            const summary = document.getElementById('resultSummary');
            let currentHTML = summary.innerHTML;
            
            achievementIds.forEach(achId => {
                const ach = achievements[achId];
                currentHTML += `<br><span style="color: #e67e22; font-weight: bold;">${ach.icon} –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –¥–ª—è ${studentName}: ${ach.name} - ${ach.desc}</span>`;
            });
            
            summary.innerHTML = currentHTML;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞ –≤–∫–ª–∞–¥–∫–∞
            if (document.getElementById('achievementsSection').classList.contains('active')) {
                showAchievements();
            }
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥
        function backToTopics() {
            stopTimer();
            document.getElementById('quizArea').style.display = 'none';
            document.getElementById('topicSelection').style.display = 'block';
        }

        function backToGrades() {
            stopTimer();
            document.getElementById('topicSelection').style.display = 'none';
            document.getElementById('gradeSelection').style.display = 'block';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>